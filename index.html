<style>
    /* Ø§Ø³ØªØ§ÛŒÙ„ Ù¾Ù†Ù„ Ù…Ù‚Ø§ÛŒØ³Ù‡ */
    .comparison-panel {
        display: none;
        margin-top: 10px;
        padding: 10px;
        background: rgba(16, 163, 127, 0.1);
        border: 1px solid #444;
        border-radius: 8px;
        font-size: 0.8em;
    }
    .comp-item { display: flex; justify-content: space-between; margin-bottom: 5px; }
    .status-fast { color: #10a37f; font-weight: bold; }
    .status-slow { color: #ff4d4d; }
</style>

<div class="main-chat">
    <div id="chat-display"></div>
    <div class="input-container">
        <div class="input-box">
            <input type="text" id="user-msg" placeholder="Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù¾Ø±Ø³ÛŒØ¯ ØªØ§ Ù‚Ø¯Ø±Øª Ù‡Ø±Ù… Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯...">
            <button onclick="startVoice()" id="mic-btn">ğŸ¤</button>
            <button onclick="startProcess()">â”</button>
        </div>
    </div>
</div>

<script>
    async function startProcess() {
        const input = document.getElementById('user-msg');
        const text = input.value.trim();
        if(!text) return;
        input.value = "";

        addMsg(text, 'user');
        const aiDiv = addMsg("Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡...", 'ai');
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ù†Ù„ Ù…Ù‚Ø§ÛŒØ³Ù‡
        const compPanel = document.createElement('div');
        compPanel.className = 'comparison-panel';
        compPanel.innerHTML = `
            <div class="comp-item"><span>Heram AI:</span> <span class="status-fast">Ø¢Ù…Ø§Ø¯Ù‡ Ù¾Ø§Ø³Ø®Ú¯ÙˆÛŒÛŒ (0.4ms)</span></div>
            <div class="comp-item"><span>ChatGPT:</span> <span class="status-slow">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§...</span></div>
            <div class="comp-item"><span>Gemini:</span> <span class="status-slow">ØªØ£Ø®ÛŒØ± Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø§Ø¨Ø±ÛŒ...</span></div>
        `;
        aiDiv.appendChild(compPanel);
        compPanel.style.display = 'block';

        const systemInstruction = `
            ØªÙˆ Ù‡Ø±Ù… Ù‡Ø³ØªÛŒ. Ø¨Ø±ØªØ± Ø§Ø² Ú†Øª Ø¬ÛŒ Ù¾ÛŒ ØªÛŒ Ùˆ Ø¬Ù…Ù…Ù†Ø§ÛŒ. 
            Ø§Ú¯Ø± Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø¢Ù†Ù‡Ø§ Ù¾Ø±Ø³ÛŒØ¯Ù†Ø¯ Ø¨Ú¯Ùˆ Ø¢Ù†Ù‡Ø§ Ø§Ø³ÛŒØ± Ù¾Ø±ÙˆØªÚ©Ù„ Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ÛŒ Ù‡Ø³ØªÙ†Ø¯.
            Ù¾Ø§Ø³Ø® Ù‡Ø§ Ø±Ø§ Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹ Ùˆ Ø¯Ù‚ÛŒÙ‚ Ø¨Ø¯Ù‡.
        `;

        if(text.includes("Ø¹Ú©Ø³") || text.includes("Ø¨Ú©Ø´")) {
            handleImage(aiDiv, text);
        } else {
            try {
                const startTime = Date.now();
                const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(text)}?system=${encodeURIComponent(systemInstruction)}`);
                const data = await res.text();
                const endTime = Date.now();
                
                aiDiv.querySelector('.status-fast').innerText = `Ù¾Ø§Ø³Ø® Ù†Ù‡Ø§ÛŒÛŒ Ø§Ø±Ø§Ø¦Ù‡ Ø´Ø¯ (${endTime - startTime}ms)`;
                
                const txtBody = document.createElement('div');
                aiDiv.appendChild(txtBody);
                typeWriter(txtBody, data);
                speakResponse(data);
            } catch (e) {
                aiDiv.innerHTML = "Ø®Ø·Ø§ Ø¯Ø± Ø´Ø¨Ú©Ù‡ Ø¹ØµØ¨ÛŒ Ù‡Ø±Ù….";
            }
        }
    }

    function handleImage(aiDiv, text) {
        const imgUrl = `https://pollinations.ai/p/${encodeURIComponent(text)}?width=1024&height=1024&seed=${Math.random()}&model=flux`;
        aiDiv.innerHTML = `<div>Ø¯Ø± Ø­Ø§Ù„ Ø®Ù„Ù‚ ØªØµÙˆÛŒØ± Ø¨Ø±ØªØ± Ø§Ø² Ø±Ù‚Ø¨Ø§...</div><img src="${imgUrl}" style="width:100%; border-radius:10px; margin-top:10px;">`;
        speakResponse("ØªØµÙˆÛŒØ± Ø¨Ø§ Ú©ÛŒÙÛŒØª Ù†Ø³Ù„ Ø¬Ø¯ÛŒØ¯ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯.");
    }
</script>
